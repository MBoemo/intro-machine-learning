<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Support vector machines | An Introduction to Machine Learning</title>
  <meta name="description" content="Course materials for An Introduction to Machine Learning" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Support vector machines | An Introduction to Machine Learning" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/cover_image.png" />
  <meta property="og:description" content="Course materials for An Introduction to Machine Learning" />
  <meta name="github-repo" content="bioinformatics-training/intro-machine-learning-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Support vector machines | An Introduction to Machine Learning" />
  
  <meta name="twitter:description" content="Course materials for An Introduction to Machine Learning" />
  <meta name="twitter:image" content="/figures/cover_image.png" />

<meta name="author" content="Sudhakaran Prabakaran, Matt Wayland and Chris Penfold" />


<meta name="date" content="2023-01-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nearest-neighbours.html"/>
<link rel="next" href="decision-trees.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About the course</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#registration"><i class="fa fa-check"></i><b>1.2</b> Registration</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.3</b> Prerequisites</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#github"><i class="fa fa-check"></i><b>1.4</b> Github</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.6</b> Contact</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i><b>1.7</b> Colophon</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-machine-learning"><i class="fa fa-check"></i><b>2.1</b> What is machine learning?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#aspects-of-ml"><i class="fa fa-check"></i><b>2.2</b> Aspects of ML</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#what-actually-happened-under-the-hood"><i class="fa fa-check"></i><b>2.3</b> What actually happened under the hood</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#introduction-to-caret"><i class="fa fa-check"></i><b>2.4</b> Introduction to CARET</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#preprocessing-with-the-iris-dataset"><i class="fa fa-check"></i><b>2.4.1</b> Preprocessing with the Iris dataset</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#training-different-types-of-models"><i class="fa fa-check"></i><b>2.4.2</b> Training different types of models</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#cross-validation"><i class="fa fa-check"></i><b>2.4.3</b> Cross-validation</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#optimising-hyperparameters"><i class="fa fa-check"></i><b>2.4.4</b> Optimising hyperparameters</a></li>
<li class="chapter" data-level="2.4.5" data-path="intro.html"><a href="intro.html#using-dummy-variables-with-the-sacramento-dataset"><i class="fa fa-check"></i><b>2.4.5</b> Using dummy variables with the Sacramento dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html"><i class="fa fa-check"></i><b>3</b> Dimensionality reduction</a><ul>
<li class="chapter" data-level="3.1" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#linear-dimensionality-reduction"><i class="fa fa-check"></i><b>3.1</b> Linear Dimensionality Reduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#interpreting-the-principle-component-axes"><i class="fa fa-check"></i><b>3.1.1</b> Interpreting the Principle Component Axes</a></li>
<li class="chapter" data-level="3.1.2" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#horseshoe-effect"><i class="fa fa-check"></i><b>3.1.2</b> Horseshoe effect</a></li>
<li class="chapter" data-level="3.1.3" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#pca-analysis-of-mammalian-development"><i class="fa fa-check"></i><b>3.1.3</b> PCA analysis of mammalian development</a></li>
<li class="chapter" data-level="3.1.4" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#biological-interpretation"><i class="fa fa-check"></i><b>3.1.4</b> Biological interpretation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#nonlinear-dimensionality-reduction"><i class="fa fa-check"></i><b>3.2</b> Nonlinear Dimensionality Reduction</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#nonlinear-warping"><i class="fa fa-check"></i><b>3.2.1</b> Nonlinear warping</a></li>
<li class="chapter" data-level="3.2.2" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#stochasticity"><i class="fa fa-check"></i><b>3.2.2</b> Stochasticity</a></li>
<li class="chapter" data-level="3.2.3" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#analysis-of-mammalian-development"><i class="fa fa-check"></i><b>3.2.3</b> Analysis of mammalian development</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html#other-dimensionality-reduction-techniques"><i class="fa fa-check"></i><b>3.3</b> Other dimensionality reduction techniques</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>4</b> Clustering</a><ul>
<li class="chapter" data-level="4.1" data-path="clustering.html"><a href="clustering.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="clustering.html"><a href="clustering.html#distance-metrics"><i class="fa fa-check"></i><b>4.2</b> Distance metrics</a></li>
<li class="chapter" data-level="4.3" data-path="clustering.html"><a href="clustering.html#hierarchic-agglomerative"><i class="fa fa-check"></i><b>4.3</b> Hierarchic agglomerative</a><ul>
<li class="chapter" data-level="4.3.1" data-path="clustering.html"><a href="clustering.html#linkage-algorithms"><i class="fa fa-check"></i><b>4.3.1</b> Linkage algorithms</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>4.4</b> K-means</a><ul>
<li class="chapter" data-level="4.4.1" data-path="clustering.html"><a href="clustering.html#algorithm"><i class="fa fa-check"></i><b>4.4.1</b> Algorithm</a></li>
<li class="chapter" data-level="4.4.2" data-path="clustering.html"><a href="clustering.html#choosing-initial-cluster-centres"><i class="fa fa-check"></i><b>4.4.2</b> Choosing initial cluster centres</a></li>
<li class="chapter" data-level="4.4.3" data-path="clustering.html"><a href="clustering.html#choosingK"><i class="fa fa-check"></i><b>4.4.3</b> Choosing k</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="clustering.html"><a href="clustering.html#dbscan"><i class="fa fa-check"></i><b>4.5</b> DBSCAN</a><ul>
<li class="chapter" data-level="4.5.1" data-path="clustering.html"><a href="clustering.html#algorithm-1"><i class="fa fa-check"></i><b>4.5.1</b> Algorithm</a></li>
<li class="chapter" data-level="4.5.2" data-path="clustering.html"><a href="clustering.html#implementation-in-r"><i class="fa fa-check"></i><b>4.5.2</b> Implementation in R</a></li>
<li class="chapter" data-level="4.5.3" data-path="clustering.html"><a href="clustering.html#choosing-parameters"><i class="fa fa-check"></i><b>4.5.3</b> Choosing parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="clustering.html"><a href="clustering.html#example-clustering-synthetic-data-sets"><i class="fa fa-check"></i><b>4.6</b> Example: clustering synthetic data sets</a><ul>
<li class="chapter" data-level="4.6.1" data-path="clustering.html"><a href="clustering.html#hierarchic-agglomerative-1"><i class="fa fa-check"></i><b>4.6.1</b> Hierarchic agglomerative</a></li>
<li class="chapter" data-level="4.6.2" data-path="clustering.html"><a href="clustering.html#k-means-1"><i class="fa fa-check"></i><b>4.6.2</b> K-means</a></li>
<li class="chapter" data-level="4.6.3" data-path="clustering.html"><a href="clustering.html#dbscan-1"><i class="fa fa-check"></i><b>4.6.3</b> DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="clustering.html"><a href="clustering.html#evaluating-cluster-quality"><i class="fa fa-check"></i><b>4.7</b> Evaluating cluster quality</a><ul>
<li class="chapter" data-level="4.7.1" data-path="clustering.html"><a href="clustering.html#silhouetteMethod"><i class="fa fa-check"></i><b>4.7.1</b> Silhouette method</a></li>
<li class="chapter" data-level="4.7.2" data-path="clustering.html"><a href="clustering.html#example---k-means-clustering-of-blobs-data-set"><i class="fa fa-check"></i><b>4.7.2</b> Example - k-means clustering of blobs data set</a></li>
<li class="chapter" data-level="4.7.3" data-path="clustering.html"><a href="clustering.html#example---dbscan-clustering-of-noisy-moons"><i class="fa fa-check"></i><b>4.7.3</b> Example - DBSCAN clustering of noisy moons</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="clustering.html"><a href="clustering.html#example-gene-expression-profiling-of-human-tissues"><i class="fa fa-check"></i><b>4.8</b> Example: gene expression profiling of human tissues</a><ul>
<li class="chapter" data-level="4.8.1" data-path="clustering.html"><a href="clustering.html#hierarchic-agglomerative-2"><i class="fa fa-check"></i><b>4.8.1</b> Hierarchic agglomerative</a></li>
<li class="chapter" data-level="4.8.2" data-path="clustering.html"><a href="clustering.html#k-means-2"><i class="fa fa-check"></i><b>4.8.2</b> K-means</a></li>
<li class="chapter" data-level="4.8.3" data-path="clustering.html"><a href="clustering.html#dbscan-2"><i class="fa fa-check"></i><b>4.8.3</b> DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="clustering.html"><a href="clustering.html#exercises"><i class="fa fa-check"></i><b>4.9</b> Exercises</a><ul>
<li class="chapter" data-level="4.9.1" data-path="clustering.html"><a href="clustering.html#clusteringEx1"><i class="fa fa-check"></i><b>4.9.1</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html"><i class="fa fa-check"></i><b>5</b> Nearest neighbours</a><ul>
<li class="chapter" data-level="5.1" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#classification-simulated-data"><i class="fa fa-check"></i><b>5.2</b> Classification: simulated data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#knn-function"><i class="fa fa-check"></i><b>5.2.1</b> knn function</a></li>
<li class="chapter" data-level="5.2.2" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#plotting-decision-boundaries"><i class="fa fa-check"></i><b>5.2.2</b> Plotting decision boundaries</a></li>
<li class="chapter" data-level="5.2.3" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#bias-variance-tradeoff"><i class="fa fa-check"></i><b>5.2.3</b> Bias-variance tradeoff</a></li>
<li class="chapter" data-level="5.2.4" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#choosing-k"><i class="fa fa-check"></i><b>5.2.4</b> Choosing <em>k</em></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#example-on-the-iris-dataset"><i class="fa fa-check"></i><b>5.3</b> Example on the Iris dataset</a></li>
<li class="chapter" data-level="5.4" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#knn-cell-segmentation"><i class="fa fa-check"></i><b>5.4</b> Classification: cell segmentation</a><ul>
<li class="chapter" data-level="5.4.1" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#cell-segmentation-data-set"><i class="fa fa-check"></i><b>5.4.1</b> Cell segmentation data set</a></li>
<li class="chapter" data-level="5.4.2" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#data-splitting"><i class="fa fa-check"></i><b>5.4.2</b> Data splitting</a></li>
<li class="chapter" data-level="5.4.3" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#identification-of-data-quality-issues"><i class="fa fa-check"></i><b>5.4.3</b> Identification of data quality issues</a></li>
<li class="chapter" data-level="5.4.4" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#fit-model"><i class="fa fa-check"></i><b>5.4.4</b> Fit model</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#knn-regression"><i class="fa fa-check"></i><b>5.5</b> Regression</a><ul>
<li class="chapter" data-level="5.5.1" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#partition-data"><i class="fa fa-check"></i><b>5.5.1</b> Partition data</a></li>
<li class="chapter" data-level="5.5.2" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#data-pre-processing"><i class="fa fa-check"></i><b>5.5.2</b> Data pre-processing</a></li>
<li class="chapter" data-level="5.5.3" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#search-for-optimum-k"><i class="fa fa-check"></i><b>5.5.3</b> Search for optimum <em>k</em></a></li>
<li class="chapter" data-level="5.5.4" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#use-model-to-make-predictions"><i class="fa fa-check"></i><b>5.5.4</b> Use model to make predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#exercises-1"><i class="fa fa-check"></i><b>5.6</b> Exercises</a><ul>
<li class="chapter" data-level="5.6.1" data-path="nearest-neighbours.html"><a href="nearest-neighbours.html#knnEx1"><i class="fa fa-check"></i><b>5.6.1</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="svm.html"><a href="svm.html"><i class="fa fa-check"></i><b>6</b> Support vector machines</a><ul>
<li class="chapter" data-level="6.1" data-path="svm.html"><a href="svm.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="svm.html"><a href="svm.html#maximum-margin-classifier"><i class="fa fa-check"></i><b>6.1.1</b> Maximum margin classifier</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="svm.html"><a href="svm.html#support-vector-classifier"><i class="fa fa-check"></i><b>6.2</b> Support vector classifier</a></li>
<li class="chapter" data-level="6.3" data-path="svm.html"><a href="svm.html#support-vector-machine"><i class="fa fa-check"></i><b>6.3</b> Support Vector Machine</a></li>
<li class="chapter" data-level="6.4" data-path="svm.html"><a href="svm.html#example---training-a-classifier"><i class="fa fa-check"></i><b>6.4</b> Example - training a classifier</a><ul>
<li class="chapter" data-level="6.4.1" data-path="svm.html"><a href="svm.html#setup-environment"><i class="fa fa-check"></i><b>6.4.1</b> Setup environment</a></li>
<li class="chapter" data-level="6.4.2" data-path="svm.html"><a href="svm.html#partition-data-1"><i class="fa fa-check"></i><b>6.4.2</b> Partition data</a></li>
<li class="chapter" data-level="6.4.3" data-path="svm.html"><a href="svm.html#visualize-training-data"><i class="fa fa-check"></i><b>6.4.3</b> Visualize training data</a></li>
<li class="chapter" data-level="6.4.4" data-path="svm.html"><a href="svm.html#prediction-performance-measures"><i class="fa fa-check"></i><b>6.4.4</b> Prediction performance measures</a></li>
<li class="chapter" data-level="6.4.5" data-path="svm.html"><a href="svm.html#plot-decision-boundary"><i class="fa fa-check"></i><b>6.4.5</b> Plot decision boundary</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="svm.html"><a href="svm.html#defining-your-own-model-type-to-use-in-caret"><i class="fa fa-check"></i><b>6.5</b> Defining your own model type to use in caret</a><ul>
<li class="chapter" data-level="6.5.1" data-path="svm.html"><a href="svm.html#model-cross-validation-and-tuning"><i class="fa fa-check"></i><b>6.5.1</b> Model cross-validation and tuning</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="svm.html"><a href="svm.html#iris-example"><i class="fa fa-check"></i><b>6.6</b> Iris example</a></li>
<li class="chapter" data-level="6.7" data-path="svm.html"><a href="svm.html#cell-segmentation-example"><i class="fa fa-check"></i><b>6.7</b> Cell segmentation example</a></li>
<li class="chapter" data-level="6.8" data-path="svm.html"><a href="svm.html#example---regression"><i class="fa fa-check"></i><b>6.8</b> Example - regression</a></li>
<li class="chapter" data-level="6.9" data-path="svm.html"><a href="svm.html#further-reading"><i class="fa fa-check"></i><b>6.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>7</b> Decision trees and random forests</a><ul>
<li class="chapter" data-level="7.1" data-path="decision-trees.html"><a href="decision-trees.html#decision-trees-1"><i class="fa fa-check"></i><b>7.1</b> Decision Trees</a></li>
<li class="chapter" data-level="7.2" data-path="decision-trees.html"><a href="decision-trees.html#example-code-with-categorical-data"><i class="fa fa-check"></i><b>7.2</b> Example code with categorical data</a><ul>
<li class="chapter" data-level="7.2.1" data-path="decision-trees.html"><a href="decision-trees.html#loading-packages-and-data"><i class="fa fa-check"></i><b>7.2.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="7.2.2" data-path="decision-trees.html"><a href="decision-trees.html#data-slicing"><i class="fa fa-check"></i><b>7.2.2</b> Data Slicing</a></li>
<li class="chapter" data-level="7.2.3" data-path="decision-trees.html"><a href="decision-trees.html#data-preprocessing"><i class="fa fa-check"></i><b>7.2.3</b> Data Preprocessing</a></li>
<li class="chapter" data-level="7.2.4" data-path="decision-trees.html"><a href="decision-trees.html#training-decisions-trees"><i class="fa fa-check"></i><b>7.2.4</b> Training Decisions Trees</a></li>
<li class="chapter" data-level="7.2.5" data-path="decision-trees.html"><a href="decision-trees.html#plotting-the-decision-trees"><i class="fa fa-check"></i><b>7.2.5</b> Plotting the decision trees</a></li>
<li class="chapter" data-level="7.2.6" data-path="decision-trees.html"><a href="decision-trees.html#prediction"><i class="fa fa-check"></i><b>7.2.6</b> Prediction</a></li>
<li class="chapter" data-level="7.2.7" data-path="decision-trees.html"><a href="decision-trees.html#implementing-decision-trees-directly"><i class="fa fa-check"></i><b>7.2.7</b> Implementing Decision Trees directly</a></li>
<li class="chapter" data-level="7.2.8" data-path="decision-trees.html"><a href="decision-trees.html#iris-example-for-decision-trees"><i class="fa fa-check"></i><b>7.2.8</b> Iris example for Decision Trees</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="decision-trees.html"><a href="decision-trees.html#cell-segmentation-examples"><i class="fa fa-check"></i><b>7.3</b> Cell segmentation examples</a></li>
<li class="chapter" data-level="7.4" data-path="decision-trees.html"><a href="decision-trees.html#regression-example---blood-brain-barrier"><i class="fa fa-check"></i><b>7.4</b> Regression example - Blood Brain Barrier</a><ul>
<li class="chapter" data-level="7.4.1" data-path="decision-trees.html"><a href="decision-trees.html#decision-tree"><i class="fa fa-check"></i><b>7.4.1</b> Decision tree</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="decision-trees.html"><a href="decision-trees.html#random-forest"><i class="fa fa-check"></i><b>7.5</b> Random Forest</a><ul>
<li class="chapter" data-level="7.5.1" data-path="decision-trees.html"><a href="decision-trees.html#iris-example-for-random-forests"><i class="fa fa-check"></i><b>7.5.1</b> Iris example for Random Forests</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="decision-trees.html"><a href="decision-trees.html#cell-segmentation-examples-1"><i class="fa fa-check"></i><b>7.6</b> Cell segmentation examples</a></li>
<li class="chapter" data-level="7.7" data-path="decision-trees.html"><a href="decision-trees.html#regression-example---blood-brain-barrier-1"><i class="fa fa-check"></i><b>7.7</b> Regression example - Blood Brain Barrier</a><ul>
<li class="chapter" data-level="7.7.1" data-path="decision-trees.html"><a href="decision-trees.html#random-forest-1"><i class="fa fa-check"></i><b>7.7.1</b> Random forest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="use-case-1.html"><a href="use-case-1.html"><i class="fa fa-check"></i><b>8</b> Use case 1</a><ul>
<li class="chapter" data-level="8.1" data-path="use-case-1.html"><a href="use-case-1.html#introduction-3"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="use-case-1.html"><a href="use-case-1.html#problem-automated-detection-of-malaria"><i class="fa fa-check"></i><b>8.2</b> Problem: automated detection of malaria</a></li>
<li class="chapter" data-level="8.3" data-path="use-case-1.html"><a href="use-case-1.html#challenges"><i class="fa fa-check"></i><b>8.3</b> Challenges</a></li>
<li class="chapter" data-level="8.4" data-path="use-case-1.html"><a href="use-case-1.html#getting-started"><i class="fa fa-check"></i><b>8.4</b> Getting started</a><ul>
<li class="chapter" data-level="8.4.1" data-path="use-case-1.html"><a href="use-case-1.html#load-data"><i class="fa fa-check"></i><b>8.4.1</b> Load data</a></li>
<li class="chapter" data-level="8.4.2" data-path="use-case-1.html"><a href="use-case-1.html#model-comparison"><i class="fa fa-check"></i><b>8.4.2</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="use-case-1.html"><a href="use-case-1.html#solutions"><i class="fa fa-check"></i><b>8.5</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>9</b> Linear models and matrix algebra</a><ul>
<li class="chapter" data-level="9.1" data-path="linear-models.html"><a href="linear-models.html#linear-models-1"><i class="fa fa-check"></i><b>9.1</b> Linear models</a></li>
<li class="chapter" data-level="9.2" data-path="linear-models.html"><a href="linear-models.html#matrix-algebra"><i class="fa fa-check"></i><b>9.2</b> Matrix algebra</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>10</b> Linear regression and logistic regression</a><ul>
<li class="chapter" data-level="10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#regression"><i class="fa fa-check"></i><b>10.1</b> Regression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#linear-regression"><i class="fa fa-check"></i><b>10.1.1</b> Linear regression</a></li>
<li class="chapter" data-level="10.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#polynomial-regression"><i class="fa fa-check"></i><b>10.1.2</b> Polynomial regression</a></li>
<li class="chapter" data-level="10.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#distributions-of-fits"><i class="fa fa-check"></i><b>10.1.3</b> Distributions of fits</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#classification"><i class="fa fa-check"></i><b>10.2</b> Classification</a><ul>
<li class="chapter" data-level="10.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression"><i class="fa fa-check"></i><b>10.2.1</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="logistic-regression.html"><a href="logistic-regression.html#resources"><i class="fa fa-check"></i><b>10.3</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ann.html"><a href="ann.html"><i class="fa fa-check"></i><b>11</b> Artificial neural networks</a><ul>
<li class="chapter" data-level="11.1" data-path="ann.html"><a href="ann.html#neural-networks"><i class="fa fa-check"></i><b>11.1</b> Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="use-case-2.html"><a href="use-case-2.html"><i class="fa fa-check"></i><b>12</b> Use case 2</a></li>
<li class="chapter" data-level="13" data-path="mlnn.html"><a href="mlnn.html"><i class="fa fa-check"></i><b>13</b> Deep Learning</a><ul>
<li class="chapter" data-level="13.1" data-path="mlnn.html"><a href="mlnn.html#multilayer-neural-networks"><i class="fa fa-check"></i><b>13.1</b> Multilayer Neural Networks</a><ul>
<li class="chapter" data-level="13.1.1" data-path="mlnn.html"><a href="mlnn.html#reading-in-images"><i class="fa fa-check"></i><b>13.1.1</b> Reading in images</a></li>
<li class="chapter" data-level="13.1.2" data-path="mlnn.html"><a href="mlnn.html#constructing-layers-in-kerasr"><i class="fa fa-check"></i><b>13.1.2</b> Constructing layers in kerasR</a></li>
<li class="chapter" data-level="13.1.3" data-path="mlnn.html"><a href="mlnn.html#rick-and-morty-classifier-using-deep-learning"><i class="fa fa-check"></i><b>13.1.3</b> Rick and Morty classifier using Deep Learning</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="mlnn.html"><a href="mlnn.html#convolutional-neural-networks"><i class="fa fa-check"></i><b>13.2</b> Convolutional neural networks</a><ul>
<li class="chapter" data-level="13.2.1" data-path="mlnn.html"><a href="mlnn.html#checking-the-models"><i class="fa fa-check"></i><b>13.2.1</b> Checking the models</a></li>
<li class="chapter" data-level="13.2.2" data-path="mlnn.html"><a href="mlnn.html#asking-more-precise-questions"><i class="fa fa-check"></i><b>13.2.2</b> Asking more precise questions</a></li>
<li class="chapter" data-level="13.2.3" data-path="mlnn.html"><a href="mlnn.html#more-complex-networks"><i class="fa fa-check"></i><b>13.2.3</b> More complex networks</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="mlnn.html"><a href="mlnn.html#further-reading-1"><i class="fa fa-check"></i><b>13.3</b> Further reading</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="logistic-regression.html"><a href="logistic-regression.html#resources"><i class="fa fa-check"></i><b>A</b> Resources</a><ul>
<li class="chapter" data-level="A.1" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>A.1</b> Python</a></li>
<li class="chapter" data-level="A.2" data-path="resources.html"><a href="resources.html#machine-learning-data-set-repositories"><i class="fa fa-check"></i><b>A.2</b> Machine learning data set repositories</a><ul>
<li class="chapter" data-level="A.2.1" data-path="resources.html"><a href="resources.html#mldata"><i class="fa fa-check"></i><b>A.2.1</b> MLDATA</a></li>
<li class="chapter" data-level="A.2.2" data-path="resources.html"><a href="resources.html#uci-machine-learning-repository"><i class="fa fa-check"></i><b>A.2.2</b> UCI Machine Learning Repository</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="solutions-dimensionality-reduction.html"><a href="solutions-dimensionality-reduction.html"><i class="fa fa-check"></i><b>B</b> Solutions - Dimensionality reduction</a><ul>
<li class="chapter" data-level="B.1" data-path="solutions-dimensionality-reduction.html"><a href="solutions-dimensionality-reduction.html#exercise-1."><i class="fa fa-check"></i><b>B.1</b> Exercise 1.</a></li>
<li class="chapter" data-level="B.2" data-path="solutions-dimensionality-reduction.html"><a href="solutions-dimensionality-reduction.html#exercise-2."><i class="fa fa-check"></i><b>B.2</b> Exercise 2.</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="solutions-clustering.html"><a href="solutions-clustering.html"><i class="fa fa-check"></i><b>C</b> Solutions ch. 4 - Clustering</a><ul>
<li class="chapter" data-level="C.1" data-path="solutions-clustering.html"><a href="solutions-clustering.html#exercise-1"><i class="fa fa-check"></i><b>C.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="solutions-nearest-neighbours.html"><a href="solutions-nearest-neighbours.html"><i class="fa fa-check"></i><b>D</b> Solutions ch. 7 - Nearest neighbours</a><ul>
<li class="chapter" data-level="D.1" data-path="solutions-nearest-neighbours.html"><a href="solutions-nearest-neighbours.html#exercise-1-1"><i class="fa fa-check"></i><b>D.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="solutions-svm.html"><a href="solutions-svm.html"><i class="fa fa-check"></i><b>E</b> Solutions ch. 6 - Support vector machines</a><ul>
<li class="chapter" data-level="E.1" data-path="solutions-svm.html"><a href="solutions-svm.html#exercise-1-2"><i class="fa fa-check"></i><b>E.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="solutions-decision-trees.html"><a href="solutions-decision-trees.html"><i class="fa fa-check"></i><b>F</b> Solutions ch. 9 - Decision trees and random forests</a><ul>
<li class="chapter" data-level="F.1" data-path="solutions-decision-trees.html"><a href="solutions-decision-trees.html#exercise-1-3"><i class="fa fa-check"></i><b>F.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html"><i class="fa fa-check"></i><b>G</b> Solutions chapter 8 - use case 1</a><ul>
<li class="chapter" data-level="G.1" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#preparation"><i class="fa fa-check"></i><b>G.1</b> Preparation</a><ul>
<li class="chapter" data-level="G.1.1" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#load-required-libraries"><i class="fa fa-check"></i><b>G.1.1</b> Load required libraries</a></li>
<li class="chapter" data-level="G.1.2" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#define-svm-model"><i class="fa fa-check"></i><b>G.1.2</b> Define SVM model</a></li>
<li class="chapter" data-level="G.1.3" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#setup-parallel-processing"><i class="fa fa-check"></i><b>G.1.3</b> Setup parallel processing</a></li>
<li class="chapter" data-level="G.1.4" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#load-data-1"><i class="fa fa-check"></i><b>G.1.4</b> Load data</a></li>
</ul></li>
<li class="chapter" data-level="G.2" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#assess-data-quality"><i class="fa fa-check"></i><b>G.2</b> Assess data quality</a><ul>
<li class="chapter" data-level="G.2.1" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#zero-and-near-zero-variance-predictors-1"><i class="fa fa-check"></i><b>G.2.1</b> Zero and near-zero variance predictors</a></li>
<li class="chapter" data-level="G.2.2" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#are-all-predictors-on-the-same-scale"><i class="fa fa-check"></i><b>G.2.2</b> Are all predictors on the same scale?</a></li>
<li class="chapter" data-level="G.2.3" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#redundancy-from-correlated-variables"><i class="fa fa-check"></i><b>G.2.3</b> Redundancy from correlated variables</a></li>
<li class="chapter" data-level="G.2.4" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#skewness-1"><i class="fa fa-check"></i><b>G.2.4</b> Skewness</a></li>
</ul></li>
<li class="chapter" data-level="G.3" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#infection-status-two-class-problem"><i class="fa fa-check"></i><b>G.3</b> Infection status (two-class problem)</a><ul>
<li class="chapter" data-level="G.3.1" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#model-training-and-parameter-tuning"><i class="fa fa-check"></i><b>G.3.1</b> Model training and parameter tuning</a></li>
<li class="chapter" data-level="G.3.2" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#knn"><i class="fa fa-check"></i><b>G.3.2</b> KNN</a></li>
<li class="chapter" data-level="G.3.3" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#svm-1"><i class="fa fa-check"></i><b>G.3.3</b> SVM</a></li>
<li class="chapter" data-level="G.3.4" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#decision-tree-1"><i class="fa fa-check"></i><b>G.3.4</b> Decision tree</a></li>
<li class="chapter" data-level="G.3.5" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#random-forest-2"><i class="fa fa-check"></i><b>G.3.5</b> Random forest</a></li>
<li class="chapter" data-level="G.3.6" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#compare-models"><i class="fa fa-check"></i><b>G.3.6</b> Compare models</a></li>
<li class="chapter" data-level="G.3.7" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#predict-test-set-using-our-best-model"><i class="fa fa-check"></i><b>G.3.7</b> Predict test set using our best model</a></li>
<li class="chapter" data-level="G.3.8" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#roc-curve"><i class="fa fa-check"></i><b>G.3.8</b> ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="G.4" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#discrimination-of-infective-stages-multi-class-problem"><i class="fa fa-check"></i><b>G.4</b> Discrimination of infective stages (multi-class problem)</a><ul>
<li class="chapter" data-level="G.4.1" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#define-cross-validation-procedure"><i class="fa fa-check"></i><b>G.4.1</b> Define cross-validation procedure</a></li>
<li class="chapter" data-level="G.4.2" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#knn-1"><i class="fa fa-check"></i><b>G.4.2</b> KNN</a></li>
<li class="chapter" data-level="G.4.3" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#svm-2"><i class="fa fa-check"></i><b>G.4.3</b> SVM</a></li>
<li class="chapter" data-level="G.4.4" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#decision-tree-2"><i class="fa fa-check"></i><b>G.4.4</b> Decision tree</a></li>
<li class="chapter" data-level="G.4.5" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#random-forest-3"><i class="fa fa-check"></i><b>G.4.5</b> Random forest</a></li>
<li class="chapter" data-level="G.4.6" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#compare-models-1"><i class="fa fa-check"></i><b>G.4.6</b> Compare models</a></li>
<li class="chapter" data-level="G.4.7" data-path="use-case-1-solutions.html"><a href="use-case-1-solutions.html#predict-test-set-using-our-best-model-1"><i class="fa fa-check"></i><b>G.4.7</b> Predict test set using our best model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="H" data-path="solutions-linear-models.html"><a href="solutions-linear-models.html"><i class="fa fa-check"></i><b>H</b> Solutions ch. 3 - Linear models and matrix algebra</a><ul>
<li class="chapter" data-level="H.1" data-path="solutions-linear-models.html"><a href="solutions-linear-models.html#example-2"><i class="fa fa-check"></i><b>H.1</b> Example 2</a></li>
<li class="chapter" data-level="H.2" data-path="solutions-linear-models.html"><a href="solutions-linear-models.html#example-2-1"><i class="fa fa-check"></i><b>H.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="solutions-logistic-regression.html"><a href="solutions-logistic-regression.html"><i class="fa fa-check"></i><b>I</b> Solutions ch. 4 - Linear and non-linear (logistic) regression</a></li>
<li class="chapter" data-level="J" data-path="solutions-ann.html"><a href="solutions-ann.html"><i class="fa fa-check"></i><b>J</b> Solutions ch. 10 - Artificial neural networks</a><ul>
<li class="chapter" data-level="J.1" data-path="solutions-ann.html"><a href="solutions-ann.html#exercise-1-4"><i class="fa fa-check"></i><b>J.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="K" data-path="use-case-2-solutions.html"><a href="use-case-2-solutions.html"><i class="fa fa-check"></i><b>K</b> Solutions for use case 2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="svm" class="section level1 hasAnchor">
<h1><span class="header-section-number">6</span> Support vector machines<a href="svm.html#svm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.1</span> Introduction<a href="svm.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Support vector machines (SVMs) are models of supervised learning, applicable to both classification and regression problems. The SVM is an extension of the support vector classifier (SVC), which is turn is an extension of the maximum margin classifier.</p>
<div id="maximum-margin-classifier" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.1</span> Maximum margin classifier<a href="svm.html#maximum-margin-classifier" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by definining a hyperplane. In <em>p</em>-dimensional space a hyperplane is a flat affine subspace of <em>p</em>-1. Figure <a href="svm.html#fig:svmSeparatingHyperplanes2">6.1</a> shows three separating hyperplanes and objects of two different classes. A separating hyperplane forms a natural linear decision boundary, classifying new objects according to which side of the line they are located.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmSeparatingHyperplanes2"></span>
<img src="images/svm.9.2.png" alt="Left: two classes of observations (blue, purple) and three separating hyperplanes. Right: separating hyperplane shown as black line and grid indicates decision rule. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="90%" />
<p class="caption">
Figure 6.1: Left: two classes of observations (blue, purple) and three separating hyperplanes. Right: separating hyperplane shown as black line and grid indicates decision rule. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
<p>If the classes of observations can be separated by a hyperplane, then there will in fact be an infinite number of hyperplanes. So which of the possible hyperplanes do we choose to be our decision boundary?</p>
<p>The <strong>maximal margin hyperplane</strong> is the separating hyperplane that is farthest from the training observations. The perpendicular distance from a given hyperplane to the nearest training observation is known as the <strong>margin</strong>. The maximal margin hyperplane is the separating hyperplane for which the margin is largest.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmMaximalMarginHyperplane"></span>
<img src="images/svm.9.3.png" alt="Maximal margin hyperplane shown as solid line. Margin is the distance from the solid line to either of the dashed lines. The support vectors are the points on the dashed line. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="75%" />
<p class="caption">
Figure 6.2: Maximal margin hyperplane shown as solid line. Margin is the distance from the solid line to either of the dashed lines. The support vectors are the points on the dashed line. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
<p>Figure <a href="svm.html#fig:svmMaximalMarginHyperplane">6.2</a> shows three training observations that are equidistant from the maximal margin hyperplane and lie on the dashed lines indicating the margin. These are the <strong>support vectors</strong>. If these points were moved slightly, the maximal margin hyperplane would also move, hence the term <em>support</em>. The maximal margin hyperplane is set by the <strong>support vectors</strong> alone; it is not influenced by any other observations.</p>
The maximal margin hyperplane is a natural decision boundary, but only if a separating hyperplane exists. In practice there may be non separable cases which prevent the use of the maximal margin classifier.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmNonSeparableCase"></span>
<img src="images/svm.9.4.png" alt="The two classes cannot be separated by a hyperplane and so the maximal margin classifier cannot be used. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="75%" />
<p class="caption">
Figure 6.3: The two classes cannot be separated by a hyperplane and so the maximal margin classifier cannot be used. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
</div>
</div>
<div id="support-vector-classifier" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.2</span> Support vector classifier<a href="svm.html#support-vector-classifier" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even if a separating hyperplane exists, it may not be the best decision boundary. The maximal margin classifier is extremely sensitive to individual observations, so may overfit the training data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmHyperplaneShift"></span>
<img src="images/svm.9.5.png" alt="Left: two classes of observations and a maximum margin hyperplane (solid line). Right: Hyperplane (solid line) moves after the addition of a new observation (original hyperplane is dashed line). Source: http://www-bcf.usc.edu/~gareth/ISL/" width="90%" />
<p class="caption">
Figure 6.4: Left: two classes of observations and a maximum margin hyperplane (solid line). Right: Hyperplane (solid line) moves after the addition of a new observation (original hyperplane is dashed line). Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
<p>It would be better to choose a classifier based on a hyperplane that:</p>
<ul>
<li>is more robust to individual observations</li>
<li>provides better classification of most of the training variables</li>
</ul>
<p>In other words, we might tolerate some misclassifications if the prediction of the remaining observations is more reliable. The <strong>support vector classifier</strong> does this by allowing some observations to be on the wrong side of the margin or even on the wrong side of the hyperplane. Observations on the wrong side of the hyperplane are misclassifications.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmObsOnWrongSideHyperplane"></span>
<img src="images/svm.9.6.png" alt="Left: observations on the wrong side of the margin. Right: observations on the wrong side of the margin and observations on the wrong side of the hyperplane. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="90%" />
<p class="caption">
Figure 6.5: Left: observations on the wrong side of the margin. Right: observations on the wrong side of the margin and observations on the wrong side of the hyperplane. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
<p>The support vector classifier has a tuning parameter, <em>C</em>, that determines the number and severity of the violations to the margin. If <em>C</em> = 0, then no violations to the margin will be tolerated, which is equivalent to the maximal margin classifier. As <em>C</em> increases, the classifier becomes more tolerant of violations to the margin, and so the margin widens.</p>
<p>The optimal value of <em>C</em> is chosen through cross-validation.</p>
<p><em>C</em> is described as a tuning parameter, because it controls the bias-variance trade-off:</p>
<ul>
<li>a small <em>C</em> results in narrow margins that are rarely violated; the model will have low bias, but high variance.</li>
<li>as <em>C</em> increases the margins widen allowing more violations; the bias of the model will increase, but its variance will decrease.</li>
</ul>
<p>The <strong>support vectors</strong> are the observations that lie directly on the margin, or on the wrong side of the margin for their class. The only observations that affect the classifier are the support vectors. As <em>C</em> increases, the margin widens and the number of support vectors increases. In other words, when <em>C</em> increases more observations are involved in determining the decision boundary of the classifier.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmMarginC"></span>
<img src="images/svm.9.7.png" alt="Margin of a support vector classifier changing with tuning parameter C. Largest value of C was used in the top left panel, and smaller values in the top right, bottom left and bottom right panels. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="75%" />
<p class="caption">
Figure 6.6: Margin of a support vector classifier changing with tuning parameter C. Largest value of C was used in the top left panel, and smaller values in the top right, bottom left and bottom right panels. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
</div>
<div id="support-vector-machine" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.3</span> Support Vector Machine<a href="svm.html#support-vector-machine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The support vector classifier performs well if we have linearly separable classes, however this isn’t always the case.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmNonLinearBoundary"></span>
<img src="images/svm.9.8.png" alt="Two classes of observations with a non-linear boundary between them." width="90%" />
<p class="caption">
Figure 6.7: Two classes of observations with a non-linear boundary between them.
</p>
</div>
<p>The SVM uses the <strong>kernel trick</strong> to operate in a higher dimensional space, without ever computing the coordinates of the data in that space.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmKernelMachine"></span>
<img src="images/svm_kernel_machine.png" alt="Kernel machine. By Alisneaky - Own work, CC0, https://commons.wikimedia.org/w/index.php?curid=14941564" width="80%" />
<p class="caption">
Figure 6.8: Kernel machine. By Alisneaky - Own work, CC0, <a href="https://commons.wikimedia.org/w/index.php?curid=14941564" class="uri">https://commons.wikimedia.org/w/index.php?curid=14941564</a>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmPolyAndRadialKernelSVM"></span>
<img src="images/svm.9.9.png" alt="Left: SVM with polynomial kernel of degree 3. Right: SVM with radial kernel. Source: http://www-bcf.usc.edu/~gareth/ISL/" width="90%" />
<p class="caption">
Figure 6.9: Left: SVM with polynomial kernel of degree 3. Right: SVM with radial kernel. Source: <a href="http://www-bcf.usc.edu/~gareth/ISL/" class="uri">http://www-bcf.usc.edu/~gareth/ISL/</a>
</p>
</div>
</div>
<div id="example---training-a-classifier" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.4</span> Example - training a classifier<a href="svm.html#example---training-a-classifier" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Training of an SVM will be demonstrated on a 2-dimensional simulated data set, with a non-linear decision boundary.</p>
<div id="setup-environment" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.4.1</span> Setup environment<a href="svm.html#setup-environment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load required libraries</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" data-line-number="1"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb350-2" data-line-number="2"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb350-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb350-4" data-line-number="4"><span class="kw">library</span>(pROC)</a>
<a class="sourceLine" id="cb350-5" data-line-number="5"><span class="kw">library</span>(e1071)</a></code></pre></div>
</div>
<div id="partition-data-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.4.2</span> Partition data<a href="svm.html#partition-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load data</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb351-1" data-line-number="1">moons &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/sim_data_svm/moons.csv&quot;</span>, <span class="dt">header=</span>F)</a>
<a class="sourceLine" id="cb351-2" data-line-number="2">moons<span class="op">$</span>V3=<span class="kw">as.factor</span>(moons<span class="op">$</span>V3)</a>
<a class="sourceLine" id="cb351-3" data-line-number="3"><span class="kw">str</span>(moons)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    400 obs. of  3 variables:
##  $ V1: num  -0.496 1.827 1.322 -1.138 -0.21 ...
##  $ V2: num  0.985 -0.501 -0.397 0.192 -0.145 ...
##  $ V3: Factor w/ 2 levels &quot;A&quot;,&quot;B&quot;: 1 2 2 1 2 1 1 2 1 2 ...</code></pre>
<p>V1 and V2 are the predictors; V3 is the class.</p>
<p>Partition data into training and test set</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb353-2" data-line-number="2">trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y=</span>moons<span class="op">$</span>V3, <span class="dt">times=</span><span class="dv">1</span>, <span class="dt">p=</span><span class="fl">0.7</span>, <span class="dt">list=</span>F)</a>
<a class="sourceLine" id="cb353-3" data-line-number="3">moonsTrain &lt;-<span class="st"> </span>moons[trainIndex,]</a>
<a class="sourceLine" id="cb353-4" data-line-number="4">moonsTest &lt;-<span class="st"> </span>moons[<span class="op">-</span>trainIndex,]</a>
<a class="sourceLine" id="cb353-5" data-line-number="5"></a>
<a class="sourceLine" id="cb353-6" data-line-number="6"><span class="kw">summary</span>(moonsTrain<span class="op">$</span>V3)</a></code></pre></div>
<pre><code>##   A   B 
## 140 140</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" data-line-number="1"><span class="kw">summary</span>(moonsTest<span class="op">$</span>V3)</a></code></pre></div>
<pre><code>##  A  B 
## 60 60</code></pre>
</div>
<div id="visualize-training-data" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.4.3</span> Visualize training data<a href="svm.html#visualize-training-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" data-line-number="1">point_shapes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>)</a>
<a class="sourceLine" id="cb357-2" data-line-number="2">bp &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">3</span>,<span class="st">&quot;Dark2&quot;</span>)</a>
<a class="sourceLine" id="cb357-3" data-line-number="3">point_colours &lt;-<span class="st"> </span><span class="kw">ifelse</span>(moonsTrain<span class="op">$</span>V3<span class="op">==</span><span class="st">&quot;A&quot;</span>, bp[<span class="dv">1</span>], bp[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb357-4" data-line-number="4">point_shapes &lt;-<span class="st"> </span><span class="kw">ifelse</span>(moonsTrain<span class="op">$</span>V3<span class="op">==</span><span class="st">&quot;A&quot;</span>, <span class="dv">15</span>, <span class="dv">17</span>)</a>
<a class="sourceLine" id="cb357-5" data-line-number="5"></a>
<a class="sourceLine" id="cb357-6" data-line-number="6">point_size =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb357-7" data-line-number="7"></a>
<a class="sourceLine" id="cb357-8" data-line-number="8"><span class="kw">ggplot</span>(moonsTrain, <span class="kw">aes</span>(V1,V2)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb357-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>point_colours, <span class="dt">shape=</span>point_shapes, </a>
<a class="sourceLine" id="cb357-10" data-line-number="10">             <span class="dt">size=</span>point_size) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb357-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb357-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>), <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">15</span>),</a>
<a class="sourceLine" id="cb357-13" data-line-number="13">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmMoonsTrainSet"></span>
<img src="05-support-vector-machines_files/figure-html/svmMoonsTrainSet-1.png" alt="Scatterplot of the training data" width="50%" />
<p class="caption">
Figure 6.10: Scatterplot of the training data
</p>
</div>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb358-2" data-line-number="2">seeds =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&#39;list&#39;</span>,<span class="dt">length=</span><span class="dv">101</span>) <span class="co">#this is #folds+1 so 10+1</span></a>
<a class="sourceLine" id="cb358-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) seeds[[i]] =<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb358-4" data-line-number="4">seeds[[<span class="dv">101</span>]] =<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb358-5" data-line-number="5"></a>
<a class="sourceLine" id="cb358-6" data-line-number="6">trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb358-7" data-line-number="7">                       <span class="dt">number =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb358-8" data-line-number="8">                       <span class="dt">repeats =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb358-9" data-line-number="9">                       <span class="dt">seeds =</span> seeds,</a>
<a class="sourceLine" id="cb358-10" data-line-number="10">                       <span class="dt">classProbs=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb358-11" data-line-number="11">svmTune &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> moonsTrain[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)],</a>
<a class="sourceLine" id="cb358-12" data-line-number="12">                 <span class="dt">y =</span> moonsTrain[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb358-13" data-line-number="13">                 <span class="dt">method =</span> <span class="st">&quot;svmRadial&quot;</span>,</a>
<a class="sourceLine" id="cb358-14" data-line-number="14">                 <span class="dt">tuneLength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb358-15" data-line-number="15">                 <span class="dt">preProc =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</a>
<a class="sourceLine" id="cb358-16" data-line-number="16">                 <span class="dt">trControl =</span> trctrl)</a>
<a class="sourceLine" id="cb358-17" data-line-number="17">                 </a>
<a class="sourceLine" id="cb358-18" data-line-number="18">svmTune</a></code></pre></div>
<pre><code>## Support Vector Machines with Radial Basis Function Kernel 
## 
## 280 samples
##   2 predictor
##   2 classes: &#39;A&#39;, &#39;B&#39; 
## 
## Pre-processing: centered (2), scaled (2) 
## Resampling: Cross-Validated (10 fold, repeated 10 times) 
## Summary of sample sizes: 252, 252, 252, 252, 252, 252, ... 
## Resampling results across tuning parameters:
## 
##   C      Accuracy   Kappa    
##    0.25  0.8875000  0.7750000
##    0.50  0.8846429  0.7692857
##    1.00  0.8810714  0.7621429
##    2.00  0.8803571  0.7607143
##    4.00  0.8750000  0.7500000
##    8.00  0.8671429  0.7342857
##   16.00  0.8635714  0.7271429
##   32.00  0.8582143  0.7164286
##   64.00  0.8557143  0.7114286
## 
## Tuning parameter &#39;sigma&#39; was held constant at a value of 1.36437
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were sigma = 1.36437 and C = 0.25.</code></pre>
</div>
<div id="prediction-performance-measures" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.4.4</span> Prediction performance measures<a href="svm.html#prediction-performance-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SVM accuracy profile</p>
<p>Predictions on test set.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" data-line-number="1">svmPred &lt;-<span class="st"> </span><span class="kw">predict</span>(svmTune, moonsTest[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)])</a>
<a class="sourceLine" id="cb360-2" data-line-number="2"><span class="kw">confusionMatrix</span>(svmPred, <span class="kw">as.factor</span>(moonsTest[,<span class="dv">3</span>]))</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  A  B
##          A 59  7
##          B  1 53
##                                           
##                Accuracy : 0.9333          
##                  95% CI : (0.8729, 0.9708)
##     No Information Rate : 0.5             
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.8667          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0771          
##                                           
##             Sensitivity : 0.9833          
##             Specificity : 0.8833          
##          Pos Pred Value : 0.8939          
##          Neg Pred Value : 0.9815          
##              Prevalence : 0.5000          
##          Detection Rate : 0.4917          
##    Detection Prevalence : 0.5500          
##       Balanced Accuracy : 0.9333          
##                                           
##        &#39;Positive&#39; Class : A               
## </code></pre>
<p>Get predicted class probabilities so we can build ROC curve.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" data-line-number="1">svmProbs &lt;-<span class="st"> </span><span class="kw">predict</span>(svmTune, moonsTest[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)], <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>)</a>
<a class="sourceLine" id="cb362-2" data-line-number="2"><span class="kw">head</span>(svmProbs)</a></code></pre></div>
<pre><code>##            A          B
## 1 0.06967502 0.93032498
## 2 0.93443571 0.06556429
## 3 0.93707422 0.06292578
## 4 0.07198768 0.92801232
## 5 0.88761226 0.11238774
## 6 0.94212490 0.05787510</code></pre>
<p>Build a ROC curve.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" data-line-number="1">svmROC &lt;-<span class="st"> </span><span class="kw">roc</span>(moonsTest[,<span class="dv">3</span>], svmProbs[,<span class="st">&quot;A&quot;</span>])</a></code></pre></div>
<pre><code>## Setting levels: control = A, case = B</code></pre>
<pre><code>## Setting direction: controls &gt; cases</code></pre>
<p>Plot ROC curve.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" data-line-number="1"><span class="kw">plot</span>(svmROC, <span class="dt">type =</span> <span class="st">&quot;S&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmROCcurveMoons"></span>
<img src="05-support-vector-machines_files/figure-html/svmROCcurveMoons-1.png" alt="SVM accuracy profile." width="80%" />
<p class="caption">
Figure 6.11: SVM accuracy profile.
</p>
</div>
<p><strong>Sensitivity (true positive rate)</strong></p>
<p><em>TPR = TP/P = TP/(TP+FN)</em></p>
<p><strong>Specificity (true negative rate)</strong></p>
<p><em>SPC = TN/N = TN/(TN+FP)</em></p>
<p>Calculate area under ROC curve.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" data-line-number="1"><span class="kw">auc</span>(svmROC)</a></code></pre></div>
<pre><code>## Area under the curve: 0.9728</code></pre>
</div>
<div id="plot-decision-boundary" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.4.5</span> Plot decision boundary<a href="svm.html#plot-decision-boundary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a grid so we can predict across the full range of our variables V1 and V2.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" data-line-number="1">gridSize &lt;-<span class="st"> </span><span class="dv">150</span> </a>
<a class="sourceLine" id="cb370-2" data-line-number="2">v1limits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(moons<span class="op">$</span>V1),<span class="kw">max</span>(moons<span class="op">$</span>V1))</a>
<a class="sourceLine" id="cb370-3" data-line-number="3">tmpV1 &lt;-<span class="st"> </span><span class="kw">seq</span>(v1limits[<span class="dv">1</span>],v1limits[<span class="dv">2</span>],<span class="dt">len=</span>gridSize)</a>
<a class="sourceLine" id="cb370-4" data-line-number="4">v2limits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(moons<span class="op">$</span>V2), <span class="kw">max</span>(moons<span class="op">$</span>V2))</a>
<a class="sourceLine" id="cb370-5" data-line-number="5">tmpV2 &lt;-<span class="st"> </span><span class="kw">seq</span>(v2limits[<span class="dv">1</span>],v2limits[<span class="dv">2</span>],<span class="dt">len=</span>gridSize)</a>
<a class="sourceLine" id="cb370-6" data-line-number="6">xgrid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(tmpV1,tmpV2)</a>
<a class="sourceLine" id="cb370-7" data-line-number="7"><span class="kw">names</span>(xgrid) &lt;-<span class="st"> </span><span class="kw">names</span>(moons)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a></code></pre></div>
<p>Predict values of all elements of grid.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" data-line-number="1">V3 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(svmTune, xgrid))</a>
<a class="sourceLine" id="cb371-2" data-line-number="2">xgrid &lt;-<span class="st"> </span><span class="kw">cbind</span>(xgrid, V3)</a></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb372-1" data-line-number="1">point_shapes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>)</a>
<a class="sourceLine" id="cb372-2" data-line-number="2">point_colours &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">3</span>,<span class="st">&quot;Dark2&quot;</span>)</a>
<a class="sourceLine" id="cb372-3" data-line-number="3">point_size =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb372-4" data-line-number="4"></a>
<a class="sourceLine" id="cb372-5" data-line-number="5">trainClassNumeric &lt;-<span class="st"> </span><span class="kw">ifelse</span>(moonsTrain<span class="op">$</span>V3<span class="op">==</span><span class="st">&quot;A&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb372-6" data-line-number="6">testClassNumeric &lt;-<span class="st"> </span><span class="kw">ifelse</span>(moonsTest<span class="op">$</span>V3<span class="op">==</span><span class="st">&quot;A&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb372-7" data-line-number="7"></a>
<a class="sourceLine" id="cb372-8" data-line-number="8"><span class="kw">ggplot</span>(xgrid, <span class="kw">aes</span>(V1,V2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>point_colours[V3], <span class="dt">shape=</span><span class="dv">16</span>, <span class="dt">size=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>moonsTrain, <span class="kw">aes</span>(V1,V2), <span class="dt">col=</span>point_colours[trainClassNumeric],</a>
<a class="sourceLine" id="cb372-11" data-line-number="11">             <span class="dt">shape=</span>point_shapes[trainClassNumeric], <span class="dt">size=</span>point_size) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_contour</span>(<span class="dt">data=</span>xgrid, <span class="kw">aes</span>(<span class="dt">x=</span>V1, <span class="dt">y=</span>V2, <span class="dt">z=</span>V3), <span class="dt">breaks=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="st">&quot;grey30&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-13" data-line-number="13"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;train&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-14" data-line-number="14"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb372-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>), <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">15</span>),</a>
<a class="sourceLine" id="cb372-16" data-line-number="16">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb372-17" data-line-number="17"></a>
<a class="sourceLine" id="cb372-18" data-line-number="18"><span class="kw">ggplot</span>(xgrid, <span class="kw">aes</span>(V1,V2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span>point_colours[V3], <span class="dt">shape=</span><span class="dv">16</span>, <span class="dt">size=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>moonsTest, <span class="kw">aes</span>(V1,V2), <span class="dt">col=</span>point_colours[testClassNumeric],</a>
<a class="sourceLine" id="cb372-21" data-line-number="21">             <span class="dt">shape=</span>point_shapes[testClassNumeric], <span class="dt">size=</span>point_size) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-22" data-line-number="22"><span class="st">  </span><span class="kw">geom_contour</span>(<span class="dt">data=</span>xgrid, <span class="kw">aes</span>(<span class="dt">x=</span>V1, <span class="dt">y=</span>V2, <span class="dt">z=</span>V3), <span class="dt">breaks=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="st">&quot;grey30&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-23" data-line-number="23"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;test&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb372-24" data-line-number="24"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb372-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>), <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">15</span>),</a>
<a class="sourceLine" id="cb372-26" data-line-number="26">        <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simDataBinClassDecisionBoundarySVM"></span>
<img src="05-support-vector-machines_files/figure-html/simDataBinClassDecisionBoundarySVM-1.png" alt="Decision boundary created by radial kernel SVM." width="50%" /><img src="05-support-vector-machines_files/figure-html/simDataBinClassDecisionBoundarySVM-2.png" alt="Decision boundary created by radial kernel SVM." width="50%" />
<p class="caption">
Figure 6.12: Decision boundary created by radial kernel SVM.
</p>
</div>
</div>
</div>
<div id="defining-your-own-model-type-to-use-in-caret" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.5</span> Defining your own model type to use in caret<a href="svm.html#defining-your-own-model-type-to-use-in-caret" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Caret has over two hundred built in models, including several support vector machines:
<a href="https://topepo.github.io/caret/available-models.html" class="uri">https://topepo.github.io/caret/available-models.html</a></p>
<p>However, despite this wide range of options, you may occasionally need to define your own model. Caret does not currently have a radial SVM implemented using the <a href="https://cran.r-project.org/package=e1071">e1071 library</a>, so we will define one here.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" data-line-number="1">svmRadialE1071 &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb373-2" data-line-number="2">  <span class="dt">label =</span> <span class="st">&quot;Support Vector Machines with Radial Kernel - e1071&quot;</span>,</a>
<a class="sourceLine" id="cb373-3" data-line-number="3">  <span class="dt">library =</span> <span class="st">&quot;e1071&quot;</span>,</a>
<a class="sourceLine" id="cb373-4" data-line-number="4">  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;Regression&quot;</span>, <span class="st">&quot;Classification&quot;</span>),</a>
<a class="sourceLine" id="cb373-5" data-line-number="5">  <span class="dt">parameters =</span> <span class="kw">data.frame</span>(<span class="dt">parameter=</span><span class="st">&quot;cost&quot;</span>,</a>
<a class="sourceLine" id="cb373-6" data-line-number="6">                          <span class="dt">class=</span><span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb373-7" data-line-number="7">                          <span class="dt">label=</span><span class="st">&quot;Cost&quot;</span>),</a>
<a class="sourceLine" id="cb373-8" data-line-number="8">  <span class="dt">grid =</span> <span class="cf">function</span> (x, y, <span class="dt">len =</span> <span class="ot">NULL</span>, <span class="dt">search =</span> <span class="st">&quot;grid&quot;</span>) </a>
<a class="sourceLine" id="cb373-9" data-line-number="9">    {</a>
<a class="sourceLine" id="cb373-10" data-line-number="10">      <span class="cf">if</span> (search <span class="op">==</span><span class="st"> &quot;grid&quot;</span>) {</a>
<a class="sourceLine" id="cb373-11" data-line-number="11">        out &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">cost =</span> <span class="dv">2</span><span class="op">^</span>((<span class="dv">1</span><span class="op">:</span>len) <span class="op">-</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb373-12" data-line-number="12">      }</a>
<a class="sourceLine" id="cb373-13" data-line-number="13">      <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb373-14" data-line-number="14">        out &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">cost =</span> <span class="dv">2</span><span class="op">^</span><span class="kw">runif</span>(len, <span class="dt">min =</span> <span class="dv">-5</span>, <span class="dt">max =</span> <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb373-15" data-line-number="15">      }</a>
<a class="sourceLine" id="cb373-16" data-line-number="16">      out</a>
<a class="sourceLine" id="cb373-17" data-line-number="17">    },</a>
<a class="sourceLine" id="cb373-18" data-line-number="18">  <span class="dt">loop=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb373-19" data-line-number="19">  <span class="dt">fit=</span><span class="cf">function</span> (x, y, wts, param, lev, last, classProbs, ...) </a>
<a class="sourceLine" id="cb373-20" data-line-number="20">    {</a>
<a class="sourceLine" id="cb373-21" data-line-number="21">      <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">names</span>(<span class="kw">list</span>(...)) <span class="op">==</span><span class="st"> &quot;probability&quot;</span>) <span class="op">|</span><span class="st"> </span><span class="kw">is.numeric</span>(y)) {</a>
<a class="sourceLine" id="cb373-22" data-line-number="22">        out &lt;-<span class="st"> </span>e1071<span class="op">::</span><span class="kw">svm</span>(<span class="dt">x =</span> <span class="kw">as.matrix</span>(x), <span class="dt">y =</span> y, <span class="dt">kernel =</span> <span class="st">&quot;radial&quot;</span>, </a>
<a class="sourceLine" id="cb373-23" data-line-number="23">                          <span class="dt">cost =</span> param<span class="op">$</span>cost, ...)</a>
<a class="sourceLine" id="cb373-24" data-line-number="24">      }</a>
<a class="sourceLine" id="cb373-25" data-line-number="25">      <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb373-26" data-line-number="26">        out &lt;-<span class="st"> </span>e1071<span class="op">::</span><span class="kw">svm</span>(<span class="dt">x =</span> <span class="kw">as.matrix</span>(x), <span class="dt">y =</span> y, <span class="dt">kernel =</span> <span class="st">&quot;radial&quot;</span>, </a>
<a class="sourceLine" id="cb373-27" data-line-number="27">                          <span class="dt">cost =</span> param<span class="op">$</span>cost, <span class="dt">probability =</span> classProbs, ...)</a>
<a class="sourceLine" id="cb373-28" data-line-number="28">      }</a>
<a class="sourceLine" id="cb373-29" data-line-number="29">      out</a>
<a class="sourceLine" id="cb373-30" data-line-number="30">    },</a>
<a class="sourceLine" id="cb373-31" data-line-number="31">  <span class="dt">predict =</span> <span class="cf">function</span> (modelFit, newdata, <span class="dt">submodels =</span> <span class="ot">NULL</span>) </a>
<a class="sourceLine" id="cb373-32" data-line-number="32">    {</a>
<a class="sourceLine" id="cb373-33" data-line-number="33">      <span class="kw">predict</span>(modelFit, newdata)</a>
<a class="sourceLine" id="cb373-34" data-line-number="34">    },</a>
<a class="sourceLine" id="cb373-35" data-line-number="35">  <span class="dt">prob =</span> <span class="cf">function</span> (modelFit, newdata, <span class="dt">submodels =</span> <span class="ot">NULL</span>) </a>
<a class="sourceLine" id="cb373-36" data-line-number="36">    {</a>
<a class="sourceLine" id="cb373-37" data-line-number="37">      out &lt;-<span class="st"> </span><span class="kw">predict</span>(modelFit, newdata, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb373-38" data-line-number="38">      <span class="kw">attr</span>(out, <span class="st">&quot;probabilities&quot;</span>)</a>
<a class="sourceLine" id="cb373-39" data-line-number="39">    },</a>
<a class="sourceLine" id="cb373-40" data-line-number="40">  <span class="dt">predictors =</span> <span class="cf">function</span> (x, ...) </a>
<a class="sourceLine" id="cb373-41" data-line-number="41">    {</a>
<a class="sourceLine" id="cb373-42" data-line-number="42">      out &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(x<span class="op">$</span>terms)) </a>
<a class="sourceLine" id="cb373-43" data-line-number="43">        <span class="kw">predictors.terms</span>(x<span class="op">$</span>terms)</a>
<a class="sourceLine" id="cb373-44" data-line-number="44">      <span class="cf">else</span> x<span class="op">$</span>xNames</a>
<a class="sourceLine" id="cb373-45" data-line-number="45">      <span class="cf">if</span> (<span class="kw">is.null</span>(out)) </a>
<a class="sourceLine" id="cb373-46" data-line-number="46">        out &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">attr</span>(x, <span class="st">&quot;scaling&quot;</span>)<span class="op">$</span>x.scale<span class="op">$</span><span class="st">`</span><span class="dt">scaled:center</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb373-47" data-line-number="47">      <span class="cf">if</span> (<span class="kw">is.null</span>(out)) </a>
<a class="sourceLine" id="cb373-48" data-line-number="48">        out &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb373-49" data-line-number="49">      out</a>
<a class="sourceLine" id="cb373-50" data-line-number="50">    },</a>
<a class="sourceLine" id="cb373-51" data-line-number="51">  <span class="dt">tags =</span> <span class="kw">c</span>(<span class="st">&quot;Kernel Methods&quot;</span>, <span class="st">&quot;Support Vector Machines&quot;</span>, <span class="st">&quot;Regression&quot;</span>, <span class="st">&quot;Classifier&quot;</span>, <span class="st">&quot;Robust Methods&quot;</span>),</a>
<a class="sourceLine" id="cb373-52" data-line-number="52">  <span class="dt">levels =</span> <span class="cf">function</span>(x) x<span class="op">$</span>levels,</a>
<a class="sourceLine" id="cb373-53" data-line-number="53">  <span class="dt">sort =</span> <span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb373-54" data-line-number="54">  {</a>
<a class="sourceLine" id="cb373-55" data-line-number="55">    x[<span class="kw">order</span>(x<span class="op">$</span>cost), ]</a>
<a class="sourceLine" id="cb373-56" data-line-number="56">  }</a>
<a class="sourceLine" id="cb373-57" data-line-number="57">)</a></code></pre></div>
<p>Note that the radial SVM model we have defined has only one tuning parameter, cost (<em>C</em>). If we do not define the kernel parameter <em>gamma</em>, e1071 will automatically calculate it as 1/(data dimension); <em>i.e.</em> if we have 58 predictors, <em>gamma</em> will be 1/58 = 0.01724.</p>
<div id="model-cross-validation-and-tuning" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.5.1</span> Model cross-validation and tuning<a href="svm.html#model-cross-validation-and-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will pass the twoClassSummary function into model training through trainControl. Additionally we would like the model to predict class probabilities so that we can calculate the ROC curve, so we use the classProbs option.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb374-1" data-line-number="1">cvCtrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb374-2" data-line-number="2">                       <span class="dt">repeats =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb374-3" data-line-number="3">                       <span class="dt">number =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb374-4" data-line-number="4">                       <span class="dt">summaryFunction =</span> twoClassSummary,</a>
<a class="sourceLine" id="cb374-5" data-line-number="5">                       <span class="dt">classProbs =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb374-6" data-line-number="6">                       <span class="dt">seeds=</span>seeds)</a></code></pre></div>
<p>We set the <strong>method</strong> of the <strong>train</strong> function to <strong>svmRadial</strong> to specify a radial kernel SVM. In this implementation we only have to tune one parameter, <strong>cost</strong>. The default grid of cost parameters start at 0.25 and double at each iteration. Choosing tuneLength = 9 will give us cost parameters of 0.25, 0.5, 1, 2, 4, 8, 16, 32 and 64.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" data-line-number="1">svmTune &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> moonsTrain[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)],</a>
<a class="sourceLine" id="cb375-2" data-line-number="2">                 <span class="dt">y =</span> moonsTrain[,<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb375-3" data-line-number="3">                 <span class="dt">method =</span> svmRadialE1071,</a>
<a class="sourceLine" id="cb375-4" data-line-number="4">                 <span class="dt">tuneLength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb375-5" data-line-number="5">                 <span class="dt">preProc =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</a>
<a class="sourceLine" id="cb375-6" data-line-number="6">                 <span class="dt">metric =</span> <span class="st">&quot;ROC&quot;</span>,</a>
<a class="sourceLine" id="cb375-7" data-line-number="7">                 <span class="dt">trControl =</span> cvCtrl)</a>
<a class="sourceLine" id="cb375-8" data-line-number="8">                 </a>
<a class="sourceLine" id="cb375-9" data-line-number="9">svmTune</a></code></pre></div>
<pre><code>## Support Vector Machines with Radial Kernel - e1071 
## 
## 280 samples
##   2 predictor
##   2 classes: &#39;A&#39;, &#39;B&#39; 
## 
## Pre-processing: centered (2), scaled (2) 
## Resampling: Cross-Validated (10 fold, repeated 10 times) 
## Summary of sample sizes: 252, 252, 252, 252, 252, 252, ... 
## Resampling results across tuning parameters:
## 
##   cost   ROC        Sens       Spec     
##    0.25  0.9230612  0.8378571  0.9057143
##    0.50  0.9320918  0.8592857  0.9057143
##    1.00  0.9418878  0.8692857  0.9000000
##    2.00  0.9455102  0.8792857  0.8964286
##    4.00  0.9479082  0.8785714  0.8914286
##    8.00  0.9485204  0.8678571  0.8857143
##   16.00  0.9492857  0.8757143  0.8800000
##   32.00  0.9490816  0.8764286  0.8728571
##   64.00  0.9463776  0.8778571  0.8707143
## 
## ROC was used to select the optimal model using the largest value.
## The final value used for the model was cost = 16.</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" data-line-number="1">svmTune<span class="op">$</span>finalModel</a></code></pre></div>
<pre><code>## 
## Call:
## svm.default(x = as.matrix(x), y = y, kernel = &quot;radial&quot;, cost = param$cost, 
##     probability = classProbs)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  16 
## 
## Number of Support Vectors:  79</code></pre>
</div>
</div>
<div id="iris-example" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.6</span> Iris example<a href="svm.html#iris-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" data-line-number="1"><span class="kw">library</span>(datasets)</a>
<a class="sourceLine" id="cb379-2" data-line-number="2"><span class="kw">data</span>(iris) <span class="co">##loads the dataset, which can be accessed under the variable name iris</span></a>
<a class="sourceLine" id="cb379-3" data-line-number="3"><span class="co">## ?iris opens the documentation for the dataset</span></a>
<a class="sourceLine" id="cb379-4" data-line-number="4"><span class="kw">summary</span>(iris) <span class="co">##presents the 5 figure summary of the dataset</span></a></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" data-line-number="1"><span class="kw">str</span>(iris) <span class="co">##presents the structure of the iris dataframe</span></a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb383-2" data-line-number="2">trainTestPartition&lt;-<span class="kw">createDataPartition</span>(<span class="dt">y=</span>iris<span class="op">$</span>Species, <span class="co">#the class label, caret ensures an even split of classes</span></a>
<a class="sourceLine" id="cb383-3" data-line-number="3">                                        <span class="dt">p=</span><span class="fl">0.7</span>, <span class="co">#proportion of samples assigned to train</span></a>
<a class="sourceLine" id="cb383-4" data-line-number="4">                                        <span class="dt">list=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb383-5" data-line-number="5"><span class="kw">str</span>(trainTestPartition)</a></code></pre></div>
<pre><code>##  int [1:105, 1] 1 2 3 4 5 7 8 10 11 12 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr &quot;Resample1&quot;</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" data-line-number="1">iris.training &lt;-<span class="st"> </span>iris[ trainTestPartition,] <span class="co">#take the corresponding rows for training</span></a>
<a class="sourceLine" id="cb385-2" data-line-number="2">iris.testing  &lt;-<span class="st"> </span>iris[<span class="op">-</span>trainTestPartition,] <span class="co">#take the corresponding rows for testing by removing training rows</span></a></code></pre></div>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb386-2" data-line-number="2">seeds =<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&#39;list&#39;</span>,<span class="dt">length=</span><span class="dv">101</span>) <span class="co">#you need length #folds*#repeats + 1 so 10*10 + 1 here</span></a>
<a class="sourceLine" id="cb386-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) seeds[[i]] =<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb386-4" data-line-number="4">seeds[[<span class="dv">101</span>]] =<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb386-5" data-line-number="5"></a>
<a class="sourceLine" id="cb386-6" data-line-number="6">train_ctrl_seed_repeated =<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&#39;repeatedcv&#39;</span>,</a>
<a class="sourceLine" id="cb386-7" data-line-number="7">                              <span class="dt">number=</span><span class="dv">10</span>, <span class="co">#number of folds</span></a>
<a class="sourceLine" id="cb386-8" data-line-number="8">                              <span class="dt">repeats=</span><span class="dv">10</span>, <span class="co">#number of times to repeat cross-validation</span></a>
<a class="sourceLine" id="cb386-9" data-line-number="9">                              <span class="dt">seeds=</span>seeds)</a>
<a class="sourceLine" id="cb386-10" data-line-number="10">iris_svm &lt;-<span class="st"> </span><span class="kw">train</span>(</a>
<a class="sourceLine" id="cb386-11" data-line-number="11">                  Species <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb386-12" data-line-number="12">                  <span class="dt">data =</span> iris.training,</a>
<a class="sourceLine" id="cb386-13" data-line-number="13">                  <span class="dt">method =</span> <span class="st">&quot;svmLinear&quot;</span>,</a>
<a class="sourceLine" id="cb386-14" data-line-number="14">                  <span class="dt">parms =</span> <span class="kw">list</span>(<span class="dt">split =</span> <span class="st">&quot;gini&quot;</span>),</a>
<a class="sourceLine" id="cb386-15" data-line-number="15">                  <span class="dt">preProc =</span> <span class="kw">c</span>(<span class="st">&quot;corr&quot;</span>,<span class="st">&quot;nzv&quot;</span>,<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>,<span class="st">&quot;BoxCox&quot;</span>),</a>
<a class="sourceLine" id="cb386-16" data-line-number="16">                  <span class="dt">tuneLength=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb386-17" data-line-number="17">                  <span class="dt">trControl =</span> train_ctrl_seed_repeated</a>
<a class="sourceLine" id="cb386-18" data-line-number="18">)</a>
<a class="sourceLine" id="cb386-19" data-line-number="19">iris_svm</a></code></pre></div>
<pre><code>## Support Vector Machines with Linear Kernel 
## 
## 105 samples
##   4 predictor
##   3 classes: &#39;setosa&#39;, &#39;versicolor&#39;, &#39;virginica&#39; 
## 
## Pre-processing: centered (3), scaled (3), Box-Cox transformation (3), remove (1) 
## Resampling: Cross-Validated (10 fold, repeated 10 times) 
## Summary of sample sizes: 94, 95, 94, 93, 95, 95, ... 
## Resampling results:
## 
##   Accuracy   Kappa    
##   0.9740152  0.9605099
## 
## Tuning parameter &#39;C&#39; was held constant at a value of 1</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" data-line-number="1">iris_information_predict_train=<span class="kw">predict</span>(iris_svm,iris.training,<span class="dt">type=</span><span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb388-2" data-line-number="2"><span class="kw">confusionMatrix</span>(iris_information_predict_train,iris.training<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##             Reference
## Prediction   setosa versicolor virginica
##   setosa         35          0         0
##   versicolor      0         35         2
##   virginica       0          0        33
## 
## Overall Statistics
##                                           
##                Accuracy : 0.981           
##                  95% CI : (0.9329, 0.9977)
##     No Information Rate : 0.3333          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9714          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: setosa Class: versicolor Class: virginica
## Sensitivity                 1.0000            1.0000           0.9429
## Specificity                 1.0000            0.9714           1.0000
## Pos Pred Value              1.0000            0.9459           1.0000
## Neg Pred Value              1.0000            1.0000           0.9722
## Prevalence                  0.3333            0.3333           0.3333
## Detection Rate              0.3333            0.3333           0.3143
## Detection Prevalence        0.3333            0.3524           0.3143
## Balanced Accuracy           1.0000            0.9857           0.9714</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" data-line-number="1">iris_gini_predict=<span class="kw">predict</span>(iris_svm,iris.testing,<span class="dt">type=</span><span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb390-2" data-line-number="2"><span class="kw">confusionMatrix</span>(iris_gini_predict,iris.testing<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##             Reference
## Prediction   setosa versicolor virginica
##   setosa         15          0         0
##   versicolor      0         13         2
##   virginica       0          2        13
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9111          
##                  95% CI : (0.7878, 0.9752)
##     No Information Rate : 0.3333          
##     P-Value [Acc &gt; NIR] : 8.467e-16       
##                                           
##                   Kappa : 0.8667          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: setosa Class: versicolor Class: virginica
## Sensitivity                 1.0000            0.8667           0.8667
## Specificity                 1.0000            0.9333           0.9333
## Pos Pred Value              1.0000            0.8667           0.8667
## Neg Pred Value              1.0000            0.9333           0.9333
## Prevalence                  0.3333            0.3333           0.3333
## Detection Rate              0.3333            0.2889           0.2889
## Detection Prevalence        0.3333            0.3333           0.3333
## Balanced Accuracy           1.0000            0.9000           0.9000</code></pre>
</div>
<div id="cell-segmentation-example" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.7</span> Cell segmentation example<a href="svm.html#cell-segmentation-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load required libraries</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" data-line-number="1"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb392-2" data-line-number="2"><span class="kw">library</span>(pROC)</a>
<a class="sourceLine" id="cb392-3" data-line-number="3"><span class="kw">library</span>(e1071)</a></code></pre></div>
<p>Load data</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" data-line-number="1"><span class="kw">data</span>(segmentationData)</a></code></pre></div>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" data-line-number="1">segClass &lt;-<span class="st"> </span>segmentationData<span class="op">$</span>Class</a></code></pre></div>
<p>Extract predictors from segmentationData</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" data-line-number="1">segData &lt;-<span class="st"> </span>segmentationData[,<span class="dv">4</span><span class="op">:</span><span class="dv">59</span>]</a></code></pre></div>
<p>Partition data</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb396-2" data-line-number="2">trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y=</span>segClass, <span class="dt">times=</span><span class="dv">1</span>, <span class="dt">p=</span><span class="fl">0.5</span>, <span class="dt">list=</span>F)</a>
<a class="sourceLine" id="cb396-3" data-line-number="3">segDataTrain &lt;-<span class="st"> </span>segData[trainIndex,]</a>
<a class="sourceLine" id="cb396-4" data-line-number="4">segDataTest &lt;-<span class="st"> </span>segData[<span class="op">-</span>trainIndex,]</a>
<a class="sourceLine" id="cb396-5" data-line-number="5">segClassTrain &lt;-<span class="st"> </span>segClass[trainIndex]</a>
<a class="sourceLine" id="cb396-6" data-line-number="6">segClassTest &lt;-<span class="st"> </span>segClass[<span class="op">-</span>trainIndex]</a></code></pre></div>
<p>Set seeds for reproducibility (optional). We will be trying 9 values of the tuning parameter with 5 repeats of 10 fold cross-validation, so we need the following list of seeds.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb397-2" data-line-number="2">seeds &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="dv">51</span>)</a>
<a class="sourceLine" id="cb397-3" data-line-number="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>) seeds[[i]] &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>, <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb397-4" data-line-number="4">seeds[[<span class="dv">51</span>]] &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a></code></pre></div>
<p>We will pass the twoClassSummary function into model training through <strong>trainControl</strong>. Additionally we would like the model to predict class probabilities so that we can calculate the ROC curve, so we use the <strong>classProbs</strong> option.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" data-line-number="1">cvCtrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, </a>
<a class="sourceLine" id="cb398-2" data-line-number="2">                       <span class="dt">repeats =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb398-3" data-line-number="3">                       <span class="dt">number =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb398-4" data-line-number="4">                       <span class="dt">summaryFunction =</span> twoClassSummary,</a>
<a class="sourceLine" id="cb398-5" data-line-number="5">                       <span class="dt">classProbs =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb398-6" data-line-number="6">                       <span class="dt">seeds=</span>seeds)</a></code></pre></div>
<p>Tune SVM over the cost parameter. The default grid of cost parameters start at 0.25 and double at each iteration. Choosing <code>tuneLength = 9</code> will give us cost parameters of 0.25, 0.5, 1, 2, 4, 8, 16, 32 and 64. The train function will calculate an appropriate value of sigma (the kernel parameter) from the data.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" data-line-number="1">svmTune &lt;-<span class="st"> </span><span class="kw">train</span>(<span class="dt">x =</span> segDataTrain,</a>
<a class="sourceLine" id="cb399-2" data-line-number="2">                 <span class="dt">y =</span> segClassTrain,</a>
<a class="sourceLine" id="cb399-3" data-line-number="3">                 <span class="dt">method =</span> <span class="st">&#39;svmRadial&#39;</span>,</a>
<a class="sourceLine" id="cb399-4" data-line-number="4">                 <span class="dt">tuneLength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb399-5" data-line-number="5">                 <span class="dt">preProc =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</a>
<a class="sourceLine" id="cb399-6" data-line-number="6">                 <span class="dt">metric =</span> <span class="st">&quot;ROC&quot;</span>,</a>
<a class="sourceLine" id="cb399-7" data-line-number="7">                 <span class="dt">trControl =</span> cvCtrl)</a>
<a class="sourceLine" id="cb399-8" data-line-number="8"></a>
<a class="sourceLine" id="cb399-9" data-line-number="9">svmTune</a></code></pre></div>
<pre><code>## Support Vector Machines with Radial Basis Function Kernel 
## 
## 1010 samples
##   56 predictor
##    2 classes: &#39;PS&#39;, &#39;WS&#39; 
## 
## Pre-processing: centered (56), scaled (56) 
## Resampling: Cross-Validated (10 fold, repeated 5 times) 
## Summary of sample sizes: 909, 909, 909, 909, 909, 909, ... 
## Resampling results across tuning parameters:
## 
##   C      ROC        Sens       Spec     
##    0.25  0.8767949  0.8636923  0.6916667
##    0.50  0.8820256  0.8769231  0.6955556
##    1.00  0.8820855  0.8812308  0.7072222
##    2.00  0.8805983  0.8787692  0.7105556
##    4.00  0.8741538  0.8756923  0.6905556
##    8.00  0.8600085  0.8695385  0.6694444
##   16.00  0.8472393  0.8732308  0.6477778
##   32.00  0.8369231  0.8769231  0.6144444
##   64.00  0.8246496  0.8661538  0.6133333
## 
## Tuning parameter &#39;sigma&#39; was held constant at a value of 0.01598045
## ROC was used to select the optimal model using the largest value.
## The final values used for the model were sigma = 0.01598045 and C = 1.</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" data-line-number="1">svmTune<span class="op">$</span>finalModel</a></code></pre></div>
<pre><code>## Support Vector Machine object of class &quot;ksvm&quot; 
## 
## SV type: C-svc  (classification) 
##  parameter : cost C = 1 
## 
## Gaussian Radial Basis kernel function. 
##  Hyperparameter : sigma =  0.0159804470403774 
## 
## Number of Support Vectors : 537 
## 
## Objective Function Value : -388.0962 
## Training error : 0.132673 
## Probability model included.</code></pre>
<p>SVM accuracy profile</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" data-line-number="1"><span class="kw">plot</span>(svmTune, <span class="dt">metric =</span> <span class="st">&quot;ROC&quot;</span>, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">log =</span><span class="dv">2</span>)))</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmAccuracyProfileCellSegment"></span>
<img src="05-support-vector-machines_files/figure-html/svmAccuracyProfileCellSegment-1.png" alt="SVM accuracy profile." width="80%" />
<p class="caption">
Figure 6.13: SVM accuracy profile.
</p>
</div>
<p>Test set results</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb404-1" data-line-number="1">svmPred &lt;-<span class="st"> </span><span class="kw">predict</span>(svmTune, segDataTest)</a>
<a class="sourceLine" id="cb404-2" data-line-number="2"><span class="kw">confusionMatrix</span>(svmPred, segClassTest)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  PS  WS
##         PS 578 111
##         WS  72 248
##                                           
##                Accuracy : 0.8186          
##                  95% CI : (0.7934, 0.8419)
##     No Information Rate : 0.6442          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.5945          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.004969        
##                                           
##             Sensitivity : 0.8892          
##             Specificity : 0.6908          
##          Pos Pred Value : 0.8389          
##          Neg Pred Value : 0.7750          
##              Prevalence : 0.6442          
##          Detection Rate : 0.5728          
##    Detection Prevalence : 0.6829          
##       Balanced Accuracy : 0.7900          
##                                           
##        &#39;Positive&#39; Class : PS              
## </code></pre>
<p>Get predicted class probabilities</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb406-1" data-line-number="1">svmProbs &lt;-<span class="st"> </span><span class="kw">predict</span>(svmTune, segDataTest, <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>)</a>
<a class="sourceLine" id="cb406-2" data-line-number="2"><span class="kw">head</span>(svmProbs)</a></code></pre></div>
<pre><code>##          PS         WS
## 1 0.9015892 0.09841085
## 2 0.9127814 0.08721855
## 3 0.9699164 0.03008361
## 4 0.5828048 0.41719516
## 5 0.8283722 0.17162781
## 6 0.7702593 0.22974067</code></pre>
<p>Build a ROC curve</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb408-1" data-line-number="1">svmROC &lt;-<span class="st"> </span><span class="kw">roc</span>(segClassTest, svmProbs[,<span class="st">&quot;PS&quot;</span>])</a></code></pre></div>
<pre><code>## Setting levels: control = PS, case = WS</code></pre>
<pre><code>## Setting direction: controls &gt; cases</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" data-line-number="1"><span class="kw">auc</span>(svmROC)</a></code></pre></div>
<pre><code>## Area under the curve: 0.8912</code></pre>
<p>Plot ROC curve.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" data-line-number="1"><span class="kw">plot</span>(svmROC, <span class="dt">type =</span> <span class="st">&quot;S&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:svmROCcurveCellSegment"></span>
<img src="05-support-vector-machines_files/figure-html/svmROCcurveCellSegment-1.png" alt="SVM ROC curve for cell segmentation data set." width="80%" />
<p class="caption">
Figure 6.14: SVM ROC curve for cell segmentation data set.
</p>
</div>
<p>Calculate area under ROC curve</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" data-line-number="1"><span class="kw">auc</span>(svmROC)</a></code></pre></div>
<pre><code>## Area under the curve: 0.8912</code></pre>
</div>
<div id="example---regression" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.8</span> Example - regression<a href="svm.html#example---regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This example serves to demonstrate the use of SVMs in regression, but perhaps more importantly, it highlights the power and flexibility of the <a href="http://cran.r-project.org/web/packages/caret/index.html">caret</a> package. Earlier we used <em>k</em>-NN for a regression analysis of the <strong>BloodBrain</strong> dataset (see section 04-nearest-neighbours.Rmd). We will repeat the regression analysis, but this time we will fit a radial kernel SVM. Remarkably, a re-run of this analysis using a completely different type of model, requires changes to only two lines of code.</p>
<p>The pre-processing steps and generation of seeds are identical, therefore if the data were still in memory, we could skip this next block of code:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb416-1" data-line-number="1"><span class="kw">data</span>(BloodBrain)</a>
<a class="sourceLine" id="cb416-2" data-line-number="2"></a>
<a class="sourceLine" id="cb416-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb416-4" data-line-number="4">trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y=</span>logBBB, <span class="dt">times=</span><span class="dv">1</span>, <span class="dt">p=</span><span class="fl">0.8</span>, <span class="dt">list=</span>F)</a>
<a class="sourceLine" id="cb416-5" data-line-number="5">descrTrain &lt;-<span class="st"> </span>bbbDescr[trainIndex,]</a>
<a class="sourceLine" id="cb416-6" data-line-number="6">concRatioTrain &lt;-<span class="st"> </span>logBBB[trainIndex]</a>
<a class="sourceLine" id="cb416-7" data-line-number="7">descrTest &lt;-<span class="st"> </span>bbbDescr[<span class="op">-</span>trainIndex,]</a>
<a class="sourceLine" id="cb416-8" data-line-number="8">concRatioTest &lt;-<span class="st"> </span>logBBB[<span class="op">-</span>trainIndex]</a>
<a class="sourceLine" id="cb416-9" data-line-number="9"></a>
<a class="sourceLine" id="cb416-10" data-line-number="10">transformations &lt;-<span class="st"> </span><span class="kw">preProcess</span>(descrTrain,</a>
<a class="sourceLine" id="cb416-11" data-line-number="11">                              <span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>, <span class="st">&quot;corr&quot;</span>, <span class="st">&quot;nzv&quot;</span>),</a>
<a class="sourceLine" id="cb416-12" data-line-number="12">                              <span class="dt">cutoff=</span><span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb416-13" data-line-number="13">descrTrain &lt;-<span class="st"> </span><span class="kw">predict</span>(transformations, descrTrain)</a>
<a class="sourceLine" id="cb416-14" data-line-number="14"></a>
<a class="sourceLine" id="cb416-15" data-line-number="15"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb416-16" data-line-number="16">seeds &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="dv">26</span>)</a>
<a class="sourceLine" id="cb416-17" data-line-number="17"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>) seeds[[i]] &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>, <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb416-18" data-line-number="18">seeds[[<span class="dv">26</span>]] &lt;-<span class="st"> </span><span class="kw">sample.int</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a></code></pre></div>
<p>In the arguments to the <code>train</code> function we change <code>method</code> from <code>knn</code> to <code>svmRadialE1071</code>. The <code>tunegrid</code> parameter is replaced with <code>tuneLength = 9</code>. Now we are ready to fit an SVM model.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" data-line-number="1">svmTune2 &lt;-<span class="st"> </span><span class="kw">train</span>(descrTrain,</a>
<a class="sourceLine" id="cb417-2" data-line-number="2">                 concRatioTrain,</a>
<a class="sourceLine" id="cb417-3" data-line-number="3">                 <span class="dt">method=</span>svmRadialE1071,</a>
<a class="sourceLine" id="cb417-4" data-line-number="4">                 <span class="dt">tuneLength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb417-5" data-line-number="5">                 <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&quot;repeatedcv&quot;</span>,</a>
<a class="sourceLine" id="cb417-6" data-line-number="6">                                          <span class="dt">number =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb417-7" data-line-number="7">                                          <span class="dt">repeats =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb417-8" data-line-number="8">                                          <span class="dt">seeds=</span>seeds</a>
<a class="sourceLine" id="cb417-9" data-line-number="9">                                          )</a>
<a class="sourceLine" id="cb417-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb417-11" data-line-number="11"></a>
<a class="sourceLine" id="cb417-12" data-line-number="12">svmTune2</a></code></pre></div>
<pre><code>## Support Vector Machines with Radial Kernel - e1071 
## 
## 168 samples
##  63 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold, repeated 5 times) 
## Summary of sample sizes: 136, 134, 134, 134, 134, 134, ... 
## Resampling results across tuning parameters:
## 
##   cost   RMSE       Rsquared   MAE      
##    0.25  0.6161239  0.4980242  0.4610789
##    0.50  0.5734394  0.5332846  0.4316062
##    1.00  0.5465607  0.5505891  0.4178574
##    2.00  0.5300490  0.5661867  0.4035017
##    4.00  0.5248272  0.5712901  0.3985361
##    8.00  0.5244977  0.5718310  0.3980940
##   16.00  0.5244977  0.5718310  0.3980940
##   32.00  0.5244977  0.5718310  0.3980940
##   64.00  0.5244977  0.5718310  0.3980940
## 
## RMSE was used to select the optimal model using the smallest value.
## The final value used for the model was cost = 8.</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" data-line-number="1"><span class="kw">plot</span>(svmTune2)</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rmseCorSVM"></span>
<img src="05-support-vector-machines_files/figure-html/rmseCorSVM-1.png" alt="Root Mean Squared Error as a function of cost." width="100%" />
<p class="caption">
Figure 6.15: Root Mean Squared Error as a function of cost.
</p>
</div>
<p>Use model to predict outcomes, after first pre-processing the test set.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" data-line-number="1">descrTest &lt;-<span class="st"> </span><span class="kw">predict</span>(transformations, descrTest)</a>
<a class="sourceLine" id="cb420-2" data-line-number="2">test_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(svmTune2, descrTest)</a></code></pre></div>
<p>Prediction performance can be visualized in a scatterplot.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" data-line-number="1"><span class="kw">qplot</span>(concRatioTest, test_pred) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb421-2" data-line-number="2"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb421-3" data-line-number="3"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;predicted&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb421-4" data-line-number="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<pre><code>## Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:obsPredConcRatiosSVM"></span>
<img src="05-support-vector-machines_files/figure-html/obsPredConcRatiosSVM-1.png" alt="Concordance between observed concentration ratios and those predicted by radial kernel SVM." width="80%" />
<p class="caption">
Figure 6.16: Concordance between observed concentration ratios and those predicted by radial kernel SVM.
</p>
</div>
<p>We can also measure correlation between observed and predicted values.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" data-line-number="1"><span class="kw">cor</span>(concRatioTest, test_pred)</a></code></pre></div>
<pre><code>## [1] 0.7274762</code></pre>
</div>
<div id="further-reading" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.9</span> Further reading<a href="svm.html#further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nearest-neighbours.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="decision-trees.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
