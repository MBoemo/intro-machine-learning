# Solutions ch. 10 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##       Output
## 1  4.3907449
## 2  3.6110161
## 3  9.3270666
## 4  9.2244739
## 5  7.5929094
## 6  6.0570930
## 7  5.1892513
## 8  9.6997413
## 9  9.4490264
## 10 9.1441572
## 11 9.9400639
## 12 9.7139532
## 13 8.4744252
## 14 5.5216019
## 15 8.2950483
## 16 4.0471691
## 17 7.0235300
## 18 4.9664176
## 19 9.2808062
## 20 6.9168802
## 21 7.3162770
## 22 8.6291005
## 23 9.5669237
## 24 7.3137969
## 25 6.3849520
## 26 3.6438787
## 27 2.9722793
## 28 9.3687455
## 29 9.5754491
## 30 8.9229032
## 31 5.7027530
## 32 9.7628850
## 33 7.1000506
## 34 5.6762908
## 35 7.9429399
## 36 0.8741215
## 37 7.5219594
## 38 6.0089469
## 39 7.8857996
## 40 4.7259415
## 41 7.8261717
## 42 9.4209885
## 43 8.5681295
## 44 9.5162470
## 45 2.2256880
## 46 1.3897941
## 47 5.0387062
## 48 8.8632710
## 49 9.1654695
## 50 3.6591323
## 
## $covariate
##                 
##  [1,] 19.2786412
##  [2,] 13.0394371
##  [3,] 86.9941713
##  [4,] 85.0909191
##  [5,] 57.6522726
##  [6,] 36.6883753
##  [7,] 26.9283286
##  [8,] 94.0849822
##  [9,] 89.2840998
## [10,] 83.6156113
## [11,] 98.8048703
## [12,] 94.3608875
## [13,] 71.8158817
## [14,] 30.4880879
## [15,] 68.8078262
## [16,] 16.3795774
## [17,] 49.3299737
## [18,] 24.6653036
## [19,] 86.1333632
## [20,] 47.8432321
## [21,] 53.5279090
## [22,] 74.4613754
## [23,] 91.5260300
## [24,] 53.4916252
## [25,] 40.7676119
## [26,] 13.2778521
## [27,]  8.8344445
## [28,] 87.7733919
## [29,] 91.6892253
## [30,] 79.6182011
## [31,] 32.5213918
## [32,] 95.3139236
## [33,] 50.4107187
## [34,] 32.2202774
## [35,] 63.0902946
## [36,]  0.7640884
## [37,] 56.5798735
## [38,] 36.1074427
## [39,] 62.1858354
## [40,] 22.3345232
## [41,] 61.2489631
## [42,] 88.7550241
## [43,] 73.4128435
## [44,] 90.5589569
## [45,]  4.9536873
## [46,]  1.9315276
## [47,] 25.3885601
## [48,] 78.5575727
## [49,] 84.0058307
## [50,] 13.3892495
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <bytecode: 0x5617214af278>
## <environment: 0x5617214a6b08>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <bytecode: 0x5617214e0a90>
## <environment: 0x5617214e1468>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##         Input    Output
## 1  19.2786412 4.3907449
## 2  13.0394371 3.6110161
## 3  86.9941713 9.3270666
## 4  85.0909191 9.2244739
## 5  57.6522726 7.5929094
## 6  36.6883753 6.0570930
## 7  26.9283286 5.1892513
## 8  94.0849822 9.6997413
## 9  89.2840998 9.4490264
## 10 83.6156113 9.1441572
## 11 98.8048703 9.9400639
## 12 94.3608875 9.7139532
## 13 71.8158817 8.4744252
## 14 30.4880879 5.5216019
## 15 68.8078262 8.2950483
## 16 16.3795774 4.0471691
## 17 49.3299737 7.0235300
## 18 24.6653036 4.9664176
## 19 86.1333632 9.2808062
## 20 47.8432321 6.9168802
## 21 53.5279090 7.3162770
## 22 74.4613754 8.6291005
## 23 91.5260300 9.5669237
## 24 53.4916252 7.3137969
## 25 40.7676119 6.3849520
## 26 13.2778521 3.6438787
## 27  8.8344445 2.9722793
## 28 87.7733919 9.3687455
## 29 91.6892253 9.5754491
## 30 79.6182011 8.9229032
## 31 32.5213918 5.7027530
## 32 95.3139236 9.7628850
## 33 50.4107187 7.1000506
## 34 32.2202774 5.6762908
## 35 63.0902946 7.9429399
## 36  0.7640884 0.8741215
## 37 56.5798735 7.5219594
## 38 36.1074427 6.0089469
## 39 62.1858354 7.8857996
## 40 22.3345232 4.7259415
## 41 61.2489631 7.8261717
## 42 88.7550241 9.4209885
## 43 73.4128435 8.5681295
## 44 90.5589569 9.5162470
## 45  4.9536873 2.2256880
## 46  1.9315276 1.3897941
## 47 25.3885601 5.0387062
## 48 78.5575727 8.8632710
## 49 84.0058307 9.1654695
## 50 13.3892495 3.6591323
## 
## $exclude
## NULL
## 
## $net.result
## $net.result[[1]]
##            [,1]
##  [1,] 4.3863833
##  [2,] 3.6135919
##  [3,] 9.3329120
##  [4,] 9.2309995
##  [5,] 7.5873036
##  [6,] 6.0636533
##  [7,] 5.1874407
##  [8,] 9.6951930
##  [9,] 9.4529938
## [10,] 9.1507395
## [11,] 9.9198014
## [12,] 9.7087009
## [13,] 8.4734013
## [14,] 5.5238334
## [15,] 8.2917094
## [16,] 4.0462052
## [17,] 7.0235557
## [18,] 4.9623987
## [19,] 9.2870503
## [20,] 6.9182129
## [21,] 7.3129032
## [22,] 8.6303220
## [23,] 9.5677534
## [24,] 7.3104487
## [25,] 6.3911839
## [26,] 3.6463631
## [27,] 2.9692389
## [28,] 9.3740905
## [29,] 9.5759953
## [30,] 8.9280354
## [31,] 5.7069777
## [32,] 9.7550048
## [33,] 7.0991393
## [34,] 5.6802492
## [35,] 7.9369208
## [36,] 0.8742209
## [37,] 7.5167909
## [38,] 6.0153446
## [39,] 7.8796354
## [40,] 4.7206909
## [41,] 7.8199467
## [42,] 9.4255020
## [43,] 8.5684546
## [44,] 9.5185994
## [45,] 2.2263457
## [46,] 1.3894846
## [47,] 5.0353148
## [48,] 8.8677255
## [49,] 9.1720731
## [50,] 3.6615610
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##             [,1]        [,2]        [,3]       [,4]        [,5]      [,6]
## [1,] -0.11617539 -1.87127028 -1.31004099 -1.1614752 -2.58161083 1.1278889
## [2,]  0.07052123  0.03263214  0.05461668  0.2599873  0.03272283 0.2309346
##            [,7]        [,8]        [,9]       [,10]
## [1,] -0.3470931  2.40584653  0.77306586 -0.54560623
## [2,] -0.8084812 -0.03149815 -0.07517048  0.06229871
## 
## $weights[[1]][[2]]
##             [,1]
##  [1,]  0.5838315
##  [2,]  1.5612334
##  [3,]  1.9630565
##  [4,]  0.9376778
##  [5,]  0.9166491
##  [6,]  2.9410463
##  [7,]  1.6754633
##  [8,] -1.8135954
##  [9,] -1.8016910
## [10,] -1.6241681
## [11,]  1.3712817
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
##  [1,] -0.0076122735
##  [2,] -0.0146291236
##  [3,] -0.0006821641
##  [4,] -0.0007111563
##  [5,] -0.0013104272
##  [6,] -0.0026960746
##  [7,] -0.0044865352
##  [8,] -0.0005817414
##  [9,] -0.0006484649
## [10,] -0.0007342784
## [11,] -0.0005210350
## [12,] -0.0005780619
## [13,] -0.0009448035
## [14,] -0.0036668728
## [15,] -0.0010084205
## [16,] -0.0099098453
## [17,] -0.0016619805
## [18,] -0.0051608610
## [19,] -0.0006951630
## [20,] -0.0017441342
## [21,] -0.0014650738
## [22,] -0.0008928475
## [23,] -0.0006166623
## [24,] -0.0014665857
## [25,] -0.0022619661
## [26,] -0.0141718167
## [27,] -0.0291772173
## [28,] -0.0006705551
## [29,] -0.0006143919
## [30,] -0.0008000460
## [31,] -0.0032961195
## [32,] -0.0005654785
## [33,] -0.0016066814
## [34,] -0.0033473328
## [35,] -0.0011470812
## [36,]  4.6125896882
## [37,] -0.0013476212
## [38,] -0.0027689332
## [39,] -0.0011717405
## [40,] -0.0060356064
## [41,] -0.0011982371
## [42,] -0.0006561396
## [43,] -0.0009130395
## [44,] -0.0006302395
## [45,] -0.0799896753
## [46,] -0.6968137876
## [47,] -0.0049293686
## [48,] -0.0008183360
## [49,] -0.0007281056
## [50,] -0.0139663335
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##             [,1]       [,2]       [,3]      [,4]       [,5]     [,6]       [,7]
## [1,] -0.00642723 -1.4600689 -0.7322608 0.7490336 -0.3800834 1.991257 -0.1464511
## [2,]  0.13290059  0.4093901  0.5916055 0.7323917  1.7498745 1.286455 -0.8123345
##            [,8]       [,9]      [,10]
## [1,]  1.0148169  0.3546321 0.05322583
## [2,] -0.2998457 -1.6331769 0.40907228
## 
## $startweights[[1]][[2]]
##               [,1]
##  [1,] -0.379436884
##  [2,]  0.419533345
##  [3,] -0.170668133
##  [4,] -0.117242350
##  [5,]  0.006570614
##  [6,]  0.752787783
##  [7,]  0.735367391
##  [8,]  0.531794163
##  [9,] -0.449071076
## [10,]  1.157294431
## [11,]  0.229584067
## 
## 
## 
## $result.matrix
##                                 [,1]
## error                   6.596787e-04
## reached.threshold       9.286343e-03
## steps                   3.407000e+03
## Intercept.to.1layhid1  -1.161754e-01
## Input.to.1layhid1       7.052123e-02
## Intercept.to.1layhid2  -1.871270e+00
## Input.to.1layhid2       3.263214e-02
## Intercept.to.1layhid3  -1.310041e+00
## Input.to.1layhid3       5.461668e-02
## Intercept.to.1layhid4  -1.161475e+00
## Input.to.1layhid4       2.599873e-01
## Intercept.to.1layhid5  -2.581611e+00
## Input.to.1layhid5       3.272283e-02
## Intercept.to.1layhid6   1.127889e+00
## Input.to.1layhid6       2.309346e-01
## Intercept.to.1layhid7  -3.470931e-01
## Input.to.1layhid7      -8.084812e-01
## Intercept.to.1layhid8   2.405847e+00
## Input.to.1layhid8      -3.149815e-02
## Intercept.to.1layhid9   7.730659e-01
## Input.to.1layhid9      -7.517048e-02
## Intercept.to.1layhid10 -5.456062e-01
## Input.to.1layhid10      6.229871e-02
## Intercept.to.Output     5.838315e-01
## 1layhid1.to.Output      1.561233e+00
## 1layhid2.to.Output      1.963057e+00
## 1layhid3.to.Output      9.376778e-01
## 1layhid4.to.Output      9.166491e-01
## 1layhid5.to.Output      2.941046e+00
## 1layhid6.to.Output      1.675463e+00
## 1layhid7.to.Output     -1.813595e+00
## 1layhid8.to.Output     -1.801691e+00
## 1layhid9.to.Output     -1.624168e+00
## 1layhid10.to.Output     1.371282e+00
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##            [,1]
##  [1,] 0.9908128
##  [2,] 2.0070147
##  [3,] 2.9973569
##  [4,] 3.9995672
##  [5,] 4.9962601
##  [6,] 6.0063617
##  [7,] 7.0003154
##  [8,] 7.9942105
##  [9,] 9.0058560
## [10,] 9.9744398
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1         0.9908128
## 2      4               2         2.0070147
## 3      9               3         2.9973569
## 4     16               4         3.9995672
## 5     25               5         4.9962601
## 6     36               6         6.0063617
## 7     49               7         7.0003154
## 8     64               8         7.9942105
## 9     81               9         9.0058560
## 10   100              10         9.9744398
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

